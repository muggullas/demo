# Create Windows and Linux EC2 instances
resource "aws_instance" "windows" {
  count         = var.windows_instance_count
  ami           = var.windows_ami
  instance_type = var.instance_type
  subnet_id     = var.subnet_id
  key_name      = var.key_name
  security_groups = ["sg-06e4ce3847f477b78"]

  tags = {
    Name = "WindowsInstance-${count.index + 1}"
  }
}

resource "aws_instance" "linux" {
  count         = var.linux_instance_count
  ami           = var.linux_ami
  instance_type = var.instance_type
  subnet_id     = var.subnet_id
  key_name      = var.key_name
  security_groups = ["sg-06e4ce3847f477b78"]

  tags = {
    Name = "LinuxInstance-${count.index + 1}"
  }
}

# Additional instances with different configurations
resource "aws_instance" "additional_windows" {
  count         = length(var.windows_instance_configurations)
  ami           = var.windows_instance_configurations[count.index].ami
  instance_type = var.windows_instance_configurations[count.index].instance_type
  subnet_id     = var.subnet_id
  key_name      = var.windows_instance_configurations[count.index].key_name
  security_groups = ["sg-06e4ce3847f477b78"]

  tags = {
    Name = "AdditionalWindowsInstance-${count.index + 1}"
  }
}

resource "aws_instance" "additional_linux" {
  count         = length(var.linux_instance_configurations)
  ami           = var.linux_instance_configurations[count.index].ami
  instance_type = var.linux_instance_configurations[count.index].instance_type
  subnet_id     = var.subnet_id
  key_name      = var.linux_instance_configurations[count.index].key_name
  security_groups = ["sg-06e4ce3847f477b78"]

  tags = {
    Name = "AdditionalLinuxInstance-${count.index + 1}"
  }
}
